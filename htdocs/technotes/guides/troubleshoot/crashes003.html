<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en" xml:lang="en">
<head>
<meta content="text/html; charset=us-ascii" http-equiv="Content-Type"/>
<meta content="text/css" http-equiv="Content-Style-Type"/>
<meta content="text/javascript" http-equiv="Content-Script-Type"/>
<title>Microsoft Visual C++ Version Considerations</title>
<meta content="Oracle DARB XHTML Converter (Mode = document) - Merged Version 1033" name="generator"/>
<meta content="This guide helps you to troubleshoot issues that might occur with Java Client applications created on the Java Platform, Standard Edition (Java SE) and Java HotSpot VM." name="description"/>
<meta content="2014-12-22T14:9:28Z" name="date"/>
<meta content="noarchive" name="robots"/>
<meta content="Java Platform, Standard Edition Troubleshooting Guide, Release 8" name="doctitle"/>
<meta content="Release 8" name="relnum"/>
<meta content="E54483-02" name="partnum"/>
<meta content="JSTGD" name="docid"/><link rel="stylesheet" type="text/css" href="../../../technotes/css/guide.css" />
</head>
<body>
<!-- STATIC HEADER -->

<!-- header start -->
<div id="javaseheader">
<div id="javaseheaderlogo">
<img src="../../../images/javalogo.gif"
alt="Java logo" />
</div>
<div id="javaseheaderindex">

<a href=
"../../../index.html">Documentation Contents</a>
</div>
<div class="clear"></div>
</div>

<!-- header end -->


<b>Java Platform, Standard Edition Troubleshooting Guide</b><br/>

<a href="toc.html">
                Contents</a>&nbsp;&nbsp;&nbsp;<a href="crashes002.html">
                Previous</a>&nbsp;&nbsp;&nbsp;<a href="hangloop.html">
                Next</a><hr/><a id="CIHBJAEI" name="CIHBJAEI"/>
                
<div id="JSTGD334">

<h1><span>5.3</span> Microsoft Visual C++ Version Considerations</h1>

<h2><a name="visual-studio-jni-libraries"/>5.3.1 JNI Libraries Compiled with Different Microsoft Visual Studio Version</h2>

<p>Use the <code>java</code> command option <code>-Xinternalversion</code> to
determine which version of Microsoft Visual Studio built the JDK. This version
may vary depending on the JDK release.</p>

<p>If you experience a crash with a Java
application and if you have native or JNI libraries that are compiled with a
different release of the compiler, then you must consider compatibility issues
between the runtimes. Specifically, your environment is supported only if you
follow the Microsoft guidelines when dealing with multiple runtimes. For
example, if you allocate memory using one runtime, then you must release it
using the same runtime. Unpredictable behavior or crashes can arise if you
release a resource using a different library than the one that allocated the
resource.</p>

<h2><a name="visual-studio-old-libraries"/>5.3.2 Microsoft C Runtime Library (MSVCR) Issues</h2>

<p>JDK and JRE releases prior to 8u261 use and ship the Microsoft Visual C++
2010 SP1 Redistributable Package (x86/x64), which includes
<code>MSVCR100.dll</code>. Later releases of the JDK and JRE are built with a
later version of Microsoft Visual Studio. Consequently, they use a
different set of libraries and DLLs.</p>

<p>Native applications that depended on and assumed the presence of
<code>MSCVR100.dll</code> in the JDK or JRE directory will fail to run. When
this happens, users will see an error such as:</p>

<blockquote>The code execution cannot proceed because <code>MSVCR100.dll</code>
was not found. Reinstalling the program may fix this problem.</blockquote>

<p>Rebuild these applications and ship them with modern C++ runtime
dependencies that use a later instance of Visual Studio. Ensure your
applications don't depend on third-party DLLs included with the JDK or JRE
that are not part of the JDK or JRE itself.</p>

<p>For more information, see
<a href="https://support.microsoft.com/en-us/help/2977003/the-latest-supported-visual-c-downloads">The latest supported Visual C++ downloads</a>
and
<a href="https://docs.microsoft.com/en-us/lifecycle/end-of-support/end-of-support-2020">Products Ending Support in 2020</a>
from Microsoft Docs.</p>

</div>

<a href="toc.html">
                Contents</a>&nbsp;&nbsp;&nbsp;<a href="crashes002.html">
                Previous</a>&nbsp;&nbsp;&nbsp;<a href="hangloop.html">
                Next</a><hr/>


<!--  footer start -->
<div id="javasefooter">
<div class="hr">
<hr /></div>
<div id="javasecopyright">
<img id="oraclelogofooter" src=
"../../../images/oraclelogo.gif" alt="Oracle and/or its affiliates"
border="0" width="100" height="29" name=
"oraclelogofooter" />

<a href="../../../legal/cpyr.html">Copyright
&#169;</a> 1993, 2024, Oracle and/or its affiliates. All rights
reserved.</div>
<div id="javasecontactus">
<a href=
"http://docs.oracle.com/javase/feedback.html">Contact
Us</a>
</div>
</div>
<!-- footer end -->

<!-- STATIC FOOTER -->

</body>
</html>
